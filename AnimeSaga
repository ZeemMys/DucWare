local Rayfield = loadstring(game:HttpGet('https://sirius.menu/rayfield'))()

local Window = Rayfield:CreateWindow({
    Name = "DucWare ‚Äî Anime Saga",
    Icon = 0,
    LoadingTitle = "Wait a minute, the script is loading",
    LoadingSubtitle = "by DucWare",
    Theme = "Amethyst",
    ConfigurationSaving = {
        Enabled = true,
        FolderName = "DucWare",
        FileName = "DucWareZ"
    },
    Discord = {
        Enabled = true,
        Invite = "PnHj485p",
        RememberJoins = false
    },
    KeySystem = true,
    KeySettings = {
        Title = "Get Key",
        Subtitle = "Key System",
        Note = "Key: DucWare",
        FileName = "Key",
        SaveKey = true,
        Key = {"DucWare"}
    }
})

Rayfield:Notify({
    Title = "Enjoy",
    Content = "Have Fun :)",
    Duration = 5,
    Image = "number"
})

local LobbyTab = Window:CreateTab("Lobby", 4483362458)
local GameTab = Window:CreateTab("Game", 4483362458)

local ReplicatedStorage = game:GetService("ReplicatedStorage")
local CodesEvent = ReplicatedStorage:WaitForChild("Event"):WaitForChild("Codes")

local codeList = {"Release", "SorryForDelay", "SorryForShutdown"}

LobbyTab:CreateButton({
    Name = "Redeem All Codes (Final)",
    Callback = function()
        local index = 1

        local function redeemNext()
            if index > #codeList then
                Rayfield:Notify({
                    Title = "‚úÖ Ho√†n t·∫•t",
                    Content = "ƒê√£ th·ª≠ redeem to√†n b·ªô m√£.",
                    Duration = 4
                })
                return
            end

            local code = codeList[index]
            print("üîÅ ƒêang th·ª≠ m√£:", code)

            -- K·∫øt n·ªëi ch·ªù ph·∫£n h·ªìi
            local received = false
            local connection
            connection = CodesEvent.OnClientEvent:Connect(function(response)
                received = true
                connection:Disconnect()

                Rayfield:Notify({
                    Title = "üì® M√£: " .. code,
                    Content = "Ph·∫£n h·ªìi: " .. tostring(response),
                    Duration = 3
                })

                index += 1
                task.wait(1.2)
                redeemNext()
            end)

            -- G·ª≠i m√£
            local ok, err = pcall(function()
                CodesEvent:FireServer(code)
            end)

            if not ok then
                connection:Disconnect()
                Rayfield:Notify({
                    Title = "‚ùå Kh√¥ng g·ª≠i ƒë∆∞·ª£c",
                    Content = code .. ": " .. tostring(err),
                    Duration = 3
                })
                index += 1
                task.wait(1.2)
                redeemNext()
            else
                -- Timeout n·∫øu kh√¥ng c√≥ ph·∫£n h·ªìi sau 3 gi√¢y
                task.delay(3, function()
                    if not received then
                        if connection.Connected then
                            connection:Disconnect()
                        end
                        Rayfield:Notify({
                            Title = "‚ö†Ô∏è Kh√¥ng ph·∫£n h·ªìi t·ª´ server",
                            Content = "M√£ \"" .. code .. "\" c√≥ th·ªÉ ƒë√£ g·ª≠i, nh∆∞ng server kh√¥ng tr·∫£ v·ªÅ k·∫øt qu·∫£.",
                            Duration = 4
                        })
                        index += 1
                        redeemNext()
                    end
                end)
            end
        end

        redeemNext()
    end
})

local autoFarm = false

GameTab:CreateToggle({
    Name = "Bay ƒë√°nh qu√°i (Auto)",
    CurrentValue = false,
    Callback = function(Value)
        autoFarm = Value

        -- Th√¥ng b√°o b·∫≠t/t·∫Øt
        Rayfield:Notify({
            Title = autoFarm and "üåÄ Auto Farm ƒê√£ B·∫≠t" or "‚õî Auto Farm ƒê√£ T·∫Øt",
            Content = autoFarm and "ƒêang bay ƒë√°nh qu√°i..." or "D·ª´ng farm.",
            Duration = 3
        })

        while autoFarm do
            local mobs = workspace:WaitForChild("Enemy"):GetChildren()

            for _, mob in pairs(mobs) do
                if not autoFarm then break end
                if mob:FindFirstChild("HumanoidRootPart") and mob:FindFirstChild("Humanoid") and mob.Humanoid.Health > 0 then
                    -- X√°c ƒë·ªãnh hitbox c·ªßa mob (·ªü ƒë√¢y l√† HumanoidRootPart, b·∫°n c√≥ th·ªÉ thay ƒë·ªïi ph·∫ßn n√†y t√πy thu·ªôc v√†o c·∫•u tr√∫c c·ªßa mob)
                    local mobHitbox = mob:FindFirstChild("HumanoidRootPart")

                    -- Bay ƒë·∫øn g·∫ßn mob v√† cƒÉn ch·ªânh v·ªõi hitbox
                    if mobHitbox then
                        HumanoidRootPart.CFrame = mobHitbox.CFrame + Vector3.new(0, 5, 0)
                        task.wait(0.5)

                        -- Gi·∫£ l·∫≠p ƒë√°nh v√†o hitbox, b·∫°n c√≥ th·ªÉ thay ƒë·ªïi c√°ch t·∫•n c√¥ng n·∫øu c√≥ RemoteEvent ho·∫∑c ch·ª©c nƒÉng kh√°c
                        local attackRemote = ReplicatedStorage:FindFirstChild("Event") and ReplicatedStorage.Event:FindFirstChild("Attack")
                        if attackRemote then
                            attackRemote:FireServer(mob)
                        else
                            warn("Kh√¥ng t√¨m th·∫•y Remote t·∫•n c√¥ng.")
                        end

                        -- Ch·ªù m·ªôt ch√∫t tr∆∞·ªõc khi ƒë√°nh qu√°i kh√°c
                        task.wait(1)
                    end
                end
            end

            task.wait(1)
        end
    end
})    
